# Story 2.6: Edit Brew Log

## Status
Approved

## Story
As a logged-in user, I want to view a specific brew log and update its fields if needed, so that I can correct mistakes and keep my brew history accurate.

## Acceptance Criteria
1. A Brew Log Detail page exists at `/brew-logs/:id` and displays the full BrewLog data for the owner. [Source: docs/architecture/frontend-architecture.md#routing-strategy] [Source: docs/architecture/api-specification.md#brewlog-endpoints]
2. The page provides an Edit action that allows updating: `brewMethod`, `coffeeWeight`, `waterWeight`, `grindSize`, `waterTemperature`, `brewTime`, `tastingNotes`, and `rating`. [Source: docs/architecture/data-models.md#brewlog-model]
3. Edit uses `PUT /api/v1/brewlogs/{id}`; on success, the detail view refreshes with updated values and a success toast. [Source: docs/architecture/api-specification.md#brewlog-endpoints]
4. Authorization: Only the owner can view/edit the brew log; return appropriate `401`/`403`/`404` errors and show friendly UI messages. [Source: docs/architecture/backend-architecture.md#middleware-stack]
5. Navigation: From the Coffee Detail brew history list, clicking an item takes the user to `/brew-logs/:id` (covered by Story 2.5; verified in this story for end-to-end flow). [Source: docs/prd/epic-2-coffee-brew-logging/story-25-view-brew-history.md]
6. UX: Edit interaction can be inline on the detail page or via a modal, with Cancel/Save, validation, and disabled Save until valid. [Source: docs/architecture/frontend-architecture.md#component-design-patterns]

## Tasks / Subtasks
- [ ] Frontend: Brew Log Detail page
  - [ ] Implement `apps/frontend/src/pages/BrewLogDetailPage.tsx` to fetch `GET /api/v1/brewlogs/{id}` and render fields. [Source: docs/architecture/frontend-architecture.md#routing-strategy]
  - [ ] Add Edit action to toggle an edit form (inline or modal) with validation; on save, call `PUT /api/v1/brewlogs/{id}` and refresh detail. [Source: docs/architecture/api-specification.md#brewlog-endpoints]
  - [ ] Handle 401/403/404 and display friendly messages with test IDs.
- [ ] Backend: Verify/update handler for `GET /brewlogs/{id}` and `PUT /brewlogs/{id}` as needed (owner-only). [Source: docs/architecture/backend-architecture.md#go-package-structure]
- [ ] Tests
  - [ ] Frontend: Detail renders, Edit toggles, validation, save success updates UI, and errors display as per strategy. [Source: docs/architecture/development-workflow.md#frontend-testing]
  - [ ] Backend: Tests for `GET/PUT` success, validation 400, unauthorized 401, forbidden 403, not found 404. [Source: docs/architecture/development-workflow.md#backend-testing]

## Dev Notes
The following guidance is extracted from architecture and PRD; only cited sources are in scope.

### Data Models
- BrewLog fields: `ID`, `UserID`, `CoffeeID`, `BrewMethod`, `CoffeeWeight`, `WaterWeight`, `GrindSize`, `WaterTemperature` (°C), `BrewTime` (seconds), `TastingNotes`, `Rating`, `CreatedAt`. [Source: docs/architecture/data-models.md#brewlog-model]

### API Specifications
- `GET /api/v1/brewlogs/{id}` returns a single BrewLog (owner-only). [Source: docs/architecture/api-specification.md#brewlog-endpoints]
- `PUT /api/v1/brewlogs/{id}` updates allowed fields; returns updated BrewLog (owner-only). [Source: docs/architecture/api-specification.md#brewlog-endpoints]

### Component Specifications
- Add `BrewLogDetailPage` and ensure Coffee Detail list items navigate to it (2.5). [Source: docs/architecture/frontend-architecture.md#react-component-hierarchy]
- Edit UX: Use MUI components; provide Cancel/Save, input validation, and toasts. [Source: docs/architecture/frontend-architecture.md#styling-architecture]

### Testing Requirements
- Frontend: Component and routing tests; validation; success/error handling; stable `data-testid` for selectors. [Source: docs/architecture/development-workflow.md#frontend-testing]
- Backend: Unit/integration tests for security and validation around owner-only `GET/PUT`. [Source: docs/architecture/development-workflow.md#backend-testing]

## Testing
- Backend: API tests for `GET/PUT /brewlogs/{id}` including auth and validation. [Source: docs/architecture/development-workflow.md#api-integration-testing]
- Frontend: Tests for detail view, edit flow, and error states. [Source: docs/architecture/development-workflow.md#frontend-testing]

## Change Log
| Date | Version | Description | Author |
| ---- | ------- | ----------- | ------ |
| {{DATE}} | 0.1 | Initial draft for Story 2.6 | Scrum Master |

## Dev Agent Record
### Agent Model Used
OpenAI GPT-4o-mini

### Debug Log References
- N/A — new story draft

### Completion Notes List
- N/A — new story draft

### File List
- apps/frontend/src/pages/BrewLogDetailPage.tsx (new)
- apps/frontend/src/pages/BrewLogDetailPage.test.tsx (new)
- apps/backend/internal/api/handlers/brewlog.go (ensure GET/PUT implemented)
- apps/backend/internal/api/handlers/brewlog_get_put_test.go (new)

## QA Results
_To be completed by QA Agent_
